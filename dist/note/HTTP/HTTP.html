<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HTTP协议 | BINGO BLOG</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/learn-blog/dist/logo.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css">
    <meta name="description" content="BINGO BLOG 学然后知不足 非淡泊无以明志，非宁静无以致远">
    <meta name="keywords" content="博客，前端，代码，个人博客，学习，兴趣，BINGOBLOG">
    
    <link rel="preload" href="/learn-blog/dist/assets/css/0.styles.4b1e8fc9.css" as="style"><link rel="preload" href="/learn-blog/dist/assets/js/app.af1090d3.js" as="script"><link rel="preload" href="/learn-blog/dist/assets/js/2.0abb358e.js" as="script"><link rel="preload" href="/learn-blog/dist/assets/js/6.9bb224b7.js" as="script"><link rel="prefetch" href="/learn-blog/dist/assets/js/10.c3c01bca.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/11.d25ce8da.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/12.eeab1120.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/13.de8a353d.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/14.696de213.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/15.00a9a19c.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/16.50aa149f.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/17.283f1525.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/18.1de72eeb.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/19.7e5dbf38.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/20.cc645fb1.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/21.844d1b60.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/22.9a1e9f7e.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/23.73f9b3f1.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/24.506d45b2.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/25.e409e1c1.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/26.9e8e97ea.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/27.66c5209e.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/28.41f33e11.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/29.7355ce83.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/3.436879ac.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/30.ac2eff19.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/31.3026d128.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/32.56c051a6.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/33.b94f906f.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/34.eb4915bc.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/35.b5cbc220.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/36.47826e4a.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/37.50186b53.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/38.c8e89072.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/39.c2e0a838.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/4.9ffda502.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/40.c554b66a.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/41.44fb5119.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/42.f522c4fe.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/43.d511b219.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/44.06a79163.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/45.3eab33af.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/46.795b861e.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/47.21003e2d.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/48.b5b4beed.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/49.ba56a676.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/5.d92da617.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/50.b321348e.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/51.babcbcc2.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/52.be6d9af4.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/53.712a685c.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/54.ac075311.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/55.54b66db2.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/56.7b35c613.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/57.23e82c2d.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/58.fe7e6fc0.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/59.c1ac5b07.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/60.c1179832.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/61.a65b054e.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/62.283830b4.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/63.1b3de12a.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/64.521fe57c.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/65.2322d149.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/66.f77629f3.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/67.4a6df0fd.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/68.283b3bb1.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/69.665854b3.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/7.206fdabc.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/70.621084f1.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/71.5455ed37.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/72.70e5de08.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/73.a3b87787.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/74.637ae1fd.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/75.a22c493d.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/76.264cbdb3.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/77.19c1a6ca.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/78.8de5be64.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/79.b9943536.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/8.11e67156.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/80.a6fa1809.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/81.6660925e.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/82.e44f60f7.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/83.4d52c4d9.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/84.db7f88b3.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/85.703e53eb.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/86.53acd1dd.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/87.cc0718c5.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/9.8429b030.js">
    <link rel="stylesheet" href="/learn-blog/dist/assets/css/0.styles.4b1e8fc9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/learn-blog/dist/" class="home-link router-link-active"><img src="/learn-blog/dist/logo.png" alt="BINGO BLOG" class="logo"> <span class="site-name can-hide">BINGO BLOG</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/learn-blog/dist/note/" class="nav-link router-link-active">
  博客
</a></div><div class="nav-item"><a href="/learn-blog/dist/algorithm/" class="nav-link">
  算法
</a></div> <a href="https://github.com/bingoYB/learn-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/learn-blog/dist/note/" class="nav-link router-link-active">
  博客
</a></div><div class="nav-item"><a href="/learn-blog/dist/algorithm/" class="nav-link">
  算法
</a></div> <a href="https://github.com/bingoYB/learn-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>编程思想</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>HTTP</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn-blog/dist/note/HTTP/DNS.html" class="sidebar-link">DNS</a></li><li><a href="/learn-blog/dist/note/HTTP/HTTP.html" aria-current="page" class="active sidebar-link">HTTP协议</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/HTTP/HTTP.html#http工作过程" class="sidebar-link">http工作过程</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/HTTP/HTTP.html#url-和-uri" class="sidebar-link">URL 和 URI</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/HTTP/HTTP.html#url" class="sidebar-link">URl</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/HTTP/HTTP.html#urn" class="sidebar-link">URN</a></li></ul></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/HTTP/HTTP.html#get-和-post-有什么区别" class="sidebar-link">GET 和 POST 有什么区别?</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/HTTP/HTTP.html#状态码" class="sidebar-link">状态码</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/HTTP/HTTP.html#https" class="sidebar-link">HTTPS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/HTTP/HTTP.html#秘钥交换算法" class="sidebar-link">秘钥交换算法</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/HTTP/HTTP.html#https加密过程" class="sidebar-link">https加密过程</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/HTTP/HTTP.html#tls握手过程" class="sidebar-link">TLS握手过程</a></li></ul></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/HTTP/HTTP.html#http2" class="sidebar-link">HTTP2</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/HTTP/HTTP.html#二进制分帧层" class="sidebar-link">二进制分帧层</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/HTTP/HTTP.html#报头压缩" class="sidebar-link">报头压缩</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/HTTP/HTTP.html#多路复用" class="sidebar-link">多路复用</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/HTTP/HTTP.html#服务器推送" class="sidebar-link">服务器推送：</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/HTTP/HTTP.html#http1-x存在的缺点" class="sidebar-link">http1.x存在的缺点</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/HTTP/HTTP.html#http-3特点" class="sidebar-link">HTTP 3特点</a></li></ul></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/HTTP/HTTP.html#http与代理" class="sidebar-link">HTTP与代理</a></li></ul></li><li><a href="/learn-blog/dist/note/HTTP/RPC.html" class="sidebar-link">RPC</a></li><li><a href="/learn-blog/dist/note/HTTP/TCP协议.html" class="sidebar-link">TCP 协议</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端图形学</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端工程化</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="http协议"><a href="#http协议" class="header-anchor">#</a> HTTP协议</h1> <p>HTTP协议是Hyper Text Transfer Protocol(超文本传输协议) 的缩写,是用于从万维网 (WWW:World Wide Web) 服务器传输超文本到本地浏览器的传送协议。</p> <p>HTTP是一个基于TCP/IP通信协议来传递数据 (HTML 文件, 图片文件, 查询结果等)。</p> <p>HTTP是一个属于应用层的面向对象的协议，由于其简捷、快速的方式，适用于分布式超媒体信息系统。它于1990年提出，经过几年的使用与发展，得到不断地完善和扩展。目前在WWW中使用的是HTTP/1.0的第六版，HTTP/1.1的规范化工作正在进行之中，而且HTTP-NG(Next Generation of HTTP)的建议已经提出。</p> <p>HTTP协议是由从客户机到服务器的请求(Request)和从服务器到客户机的响应(response)进行约束和规范</p> <blockquote><p>http 协议在哪一层</p></blockquote> <p><strong>ISO/OSI估计标准组织定义</strong>：应用层 表示层 会话层 传输层  网络层 数据链路层 物理层</p> <p>应用层：为用户提供服务 http ftp dns smtp</p> <p>传输层：为应用层实体提供端到端的通信功能，保证数据包的顺序传送及数据的完整性（TCP/UDP）</p> <p>网络层：IP协议 解决主机到主机的通信问题</p> <p>网络接口层（数据链路层 ：比特信号转成光信号/电信号；物理层）：监视数据在主机与网络间交换</p> <h2 id="http工作过程"><a href="#http工作过程" class="header-anchor">#</a> http工作过程</h2> <p>一次HTTP操作称为一个事务，其工作过程可分为四步:</p> <p>1、客户端与服务器建立TCP连接</p> <p>2、客户端发送请求给服务器</p> <p>3、服务器接到请求给出响应</p> <p>4、客户端收到信息展示到浏览器中，然后断开连接</p> <h2 id="url-和-uri"><a href="#url-和-uri" class="header-anchor">#</a> URL 和 URI</h2> <p>每个web 服务器资源都有一个名字,服务器资源名称被称为 <strong>统一资源标识符</strong>,如 web 服务器上一个图片资源的 URI:</p> <p>http://www.joes-hardware.com/specials/saw-blade.gif</p> <p>URI 有两种形式,分别称为 <strong>URL</strong> 和 <strong>URN</strong></p> <h3 id="url"><a href="#url" class="header-anchor">#</a> URl</h3> <p><strong>统一资源定位符 (URL)</strong> 是资源标识符最常见的形式。URL 描述了一台特定服务器 上某资源的特定位置。它们可以明确说明如何从一个精确、固定的位置获取资源</p> <p>URL 说明了协议,服务器和本地资源</p> <p>大部分 URL 都遵循一种标准格式，这种格式包含三个部分</p> <ul><li>URL的第一部分被称为 方案,说明了访问资源所使用的的协议类型. 这部分通常就是 <strong>HTTP</strong> 协议(http://)</li> <li>第二部分给出了服务器的因特网地址(如,www.joes-hardware.com)</li> <li>其余部分指定了 Web 服务器上的某个资源(如,/imgage/asw.gif)</li></ul> <p>现在,几乎所有的 URI 都是 URL</p> <h3 id="urn"><a href="#urn" class="header-anchor">#</a> URN</h3> <p>URI 的第二种形式就是统一资源名(URN). URN是作为特定内容的唯一名称使用的,与目前的资源所在地无关. 通过 URN,还可以用同一个名字通过多种网络协议来访问资源</p> <h2 id="get-和-post-有什么区别"><a href="#get-和-post-有什么区别" class="header-anchor">#</a> GET 和 POST 有什么区别?</h2> <p>差别如下:</p> <ul><li>从缓存的角度，GET 请求会被浏览器主动缓存下来，留下历史记录，而 POST 默认不会</li> <li>从编码的角度，GET 只能进行 URL 编码，只能接收 ASCII 字符，而 POST 没有限制</li> <li>从参数的角度，GET 一般放在 URL 中，因此不安全，POST 放在请求体中，更适合传输敏感信息。</li> <li>从幂等性的角度，GET是幂等的，而POST不是。(幂等表示执行相同的操作，结果也是相同的)</li> <li>从TCP的角度，GET 请求会把请求报文一次性发出去，而 POST 会分为两个 TCP 数据包，首先发 header 部分，如果服务器响应 100(continue), 然后发 body 部分。(火狐浏览器除外，它的 POST 请求只发一个 TCP 包)</li></ul> <h2 id="状态码"><a href="#状态码" class="header-anchor">#</a> 状态码</h2> <p><strong>状态代码有三位数字组成，第一个数字定义了响应的类别，共分五种类别:</strong></p> <ul><li><strong>1xx：指示信息--表示请求已接收，继续处理</strong></li> <li><strong>2xx：成功--表示请求已被成功接收、理解、接受</strong></li> <li><strong>3xx：重定向--要完成请求必须进行更进一步的操作</strong></li> <li><strong>4xx：客户端错误--请求有语法错误或请求无法实现</strong></li> <li><strong>5xx：服务器端错误--服务器未能实现合法的请求</strong></li></ul> <p><strong>常见状态码：</strong></p> <table><thead><tr><th>状态码</th> <th>解释</th></tr></thead> <tbody><tr><td>200 OK</td> <td>客户端请求成功</td></tr> <tr><td>304 Not Modified</td> <td>当协商缓存命中时会返回这个状态码</td></tr> <tr><td>400 Bad Request</td> <td>客户端请求有语法错误，不能被服务器所理解</td></tr> <tr><td>401 Unauthorized</td> <td>请求未经授权，这个状态代码必须和WWW-Authenticate报头域一起使用</td></tr> <tr><td>403 Forbidden</td> <td>服务器收到请求，但是拒绝提供服务</td></tr> <tr><td>404 Not Found</td> <td>请求资源不存在，eg：输入了错误的URL</td></tr> <tr><td>500 Internal Server Error</td> <td>服务器发生不可预期的错误</td></tr> <tr><td>503 Server Unavailable</td> <td>服务器当前不能处理客户端的请求，一段时间后可能恢复正常</td></tr></tbody></table> <h2 id="https"><a href="#https" class="header-anchor">#</a> HTTPS</h2> <h3 id="秘钥交换算法"><a href="#秘钥交换算法" class="header-anchor">#</a> 秘钥交换算法</h3> <p>1）Alice与Bob确定两个大素数n和g，这两个数不用保密</p> <p>（2）Alice选择另一个大随机数x，并计算A如下：A=gx mod n</p> <p>（3）Alice将A发给Bob</p> <p>（4）Bob选择另一个大随机数y，并计算B如下：B=gy mod n</p> <p>（5）Bob将B发给Alice</p> <p>（6）计算秘密密钥K1如下：K1=Bx mod n</p> <p>（7）计算秘密密钥K2如下：K2=Ay mod n K1=K2，因此Alice和Bob可以用其进行加解密</p> <h3 id="https加密过程"><a href="#https加密过程" class="header-anchor">#</a> https加密过程</h3> <p>认证服务器。浏览器内置一个受信任的CA机构列表，并保存了这些CA机构的证书。第一阶段服务器会提供经CA机构认证颁发的服务器证书，如果认证该服务器证书的CA机构，存在于浏览器的受信任CA机构列表中，并且服务器证书中的信息与当前正在访问的网站（域名等）一致，那么浏览器就认为服务端是可信的，并从服务器证书中取得服务器公钥，用于后续流程。否则，浏览器将提示用户，根据用户的选择，决定是否继续。当然，我们可以管理这个受信任CA机构列表，添加我们想要信任的CA机构，或者移除我们不信任的CA机构。</p> <p>协商会话密钥。客户端在认证完服务器，获得服务器的公钥之后，利用该公钥与服务器进行加密通信，协商出两个会话密钥，分别是用于加密客户端往服务端发送数据的客户端会话密钥，用于加密服务端往客户端发送数据的服务端会话密钥。在已有服务器公钥，可以加密通讯的前提下，还要协商两个对称密钥的原因，是因为非对称加密相对复杂度更高，在数据传输过程中，使用对称加密，可以节省计算资源。另外，会话密钥是随机生成，每次协商都会有不一样的结果，所以安全性也比较高。</p> <p>加密通讯。此时客户端服务器双方都有了本次通讯的会话密钥，之后传输的所有Http数据，都通过会话密钥加密。这样网路上的其它用户，将很难窃取和篡改客户端和服务端之间传输的数据，从而保证了数据的私密性和完整性。</p> <ul><li><p>https协议 SSL协议 TLS协议、握手协议的关系</p></li> <li><p>https 基于ssl的http协议</p></li> <li><p>SSL协议是一种记录协议，扩展性良好，可以方便添加子协议</p></li> <li><p>握手协议是SSL的一个子协议</p></li> <li><p>TLS是SSL的后续版本</p></li></ul> <h3 id="tls握手过程"><a href="#tls握手过程" class="header-anchor">#</a> TLS握手过程</h3> <ol><li>ClientHello：客户端发送所支持的 SSL/TLS 最高协议版本号和所支持的加密算法集合及压缩方法集合等信息给 服务器端。</li> <li>ServerHello：服务器端收到客户端信息后，选定双方都能够支持的 SSL/TLS 协议版本和加密方法及压缩方法， 返回给客户端。</li> <li>SendCertificate（可选）：服务器端发送服务端证书给客户端。</li> <li>RequestCertificate（可选）：如果选择双向验证，服务器端向客户端请求客户端证书</li> <li>ServerHelloDone：服务器端通知客户端初始协商结束。</li> <li>ResponseCertificate（可选）：如果选择双向验证，客户端向服务器端发送客户端证书。</li> <li>ClientKeyExchange：客户端使用服务器端的公钥，对客户端公钥和密钥种子进行加密，再发送给服务器端。</li> <li>CertificateVerify（可选）：如果选择双向验证，客户端用本地私钥生成数字签名，并发送给服务器端，让其通 过收到的客户端公钥进行身份验证。</li> <li>CreateSecretKey：通讯双方基于密钥种子等信息生成通讯密钥。</li> <li>ChangeCipherSpec：客户端通知服务器端已将通讯方式切换到加密模式。</li> <li>Finished：客户端做好加密通讯的准备。</li> <li>ChangeCipherSpec：服务器端通知客户端已将通讯方式切换到加密模式。</li> <li>Finished：服务器做好加密通讯的准备。</li> <li>Encrypted/DecryptedData：双方使用客户端密钥，通过对称加密算法对通讯内容进行加密。</li> <li>ClosedConnection：通讯结束后，任何一方发出断开 SSL 连接的消息。</li></ol> <p>这个过程可通过wireshark抓包分析出来</p> <p><img src="/learn-blog/dist/assets/img/http-wireshark.bc8490be.png" alt="image-20210520211145292"></p> <p>从图中就可看出主要的一些步骤信息</p> <h2 id="http2"><a href="#http2" class="header-anchor">#</a> HTTP2</h2> <p><strong>特点：</strong></p> <p>​	1、使用二进制格式传输，更高效，更紧凑；原本是用ASCII码进行传输，也就是纯文本，对于大的纯数字的时候，二进制格式占用容器更小</p> <p>​	2、报头压缩，降低开销</p> <p>​	3、多路复用，一个网络连接实现并行请求</p> <p>​	4、服务器主动推送，减少请求的延迟</p> <p>​	5、默认使用加密</p> <h3 id="二进制分帧层"><a href="#二进制分帧层" class="header-anchor">#</a> <strong>二进制分帧层</strong></h3> <p>HTTP2定义了如何封装HTTP消息在客户端与服务端的传输</p> <p>在1.1之前的模型中，HTTP消息是一串文本，以换行符作为请求头请求体的分隔符，而HTTP2则对HTTP消息进行了封装，把头与数据分成了两个更小的二进制格式数据帧。这个”层“是位于套接字接口与应用的HTTP API之间的一个优化的新编码机制，所以对应用使用不影响。</p> <p>在 HTTP/2 中，有了二进制分帧之后，HTTP 2.0不再依赖TCP链接去实现多流并行了，在HTTP/2：</p> <ul><li>同域名下所有通信都在单个连接上完成。</li> <li>单个连接可以承载任意数量的双向数据流。</li> <li>数据流以消息的形式发送，而消息又由一个或多个帧组成，多个帧之间可以乱序发送，因为根据帧首部的流标识可以重新组装。</li></ul> <p>这一特性，性能会有极大的提升，因为：</p> <ul><li>同个域名只需要占用一个TCP连接，消除了因多个TCP连接而带来的延时和内存消耗。</li> <li>单个连接上可以并行交错的请求和响应，之间互不干扰。</li></ul> <h3 id="报头压缩"><a href="#报头压缩" class="header-anchor">#</a> 报头压缩</h3> <p>在 HTTP/1 中，我们使用文本的形式传输 header，在 header 携带 cookie 的情况下，可能每次都需要重复传输几百到几千的字节。</p> <p>在 HTTP /2 中，使用了 HPACK 压缩格式对传输的 header 进行编码，减少了 header 的大小。并在两端维护了索引表，用于记录出现过的 header ，后面在传输过程中就可以传输已经记录过的 header 的键名，对端收到数据后就可以通过键名找到对应的值。</p> <h3 id="多路复用"><a href="#多路复用" class="header-anchor">#</a> <strong>多路复用</strong></h3> <p>在1.1中，客户端想要发起多个并行请求，必须使用多个TCP连接，这种模式会导致队首阻塞，降低连接效率。且在HTTP1.1中浏览器会限制一个域名的TCP连接请求数，一般为6个</p> <p>HTTP2则将消息分解成一个一个的独立数据帧，交错发送，接收端再将帧重组成HTTP消息。</p> <p>特点：1、交错发送多个请求，互不影响；2、并行交错发送多个响应，互不干扰；3、使用一个TCP连接发送多个请求和响应；4、消除不必要的延迟和提高现有网络容量的利用率；</p> <h3 id="服务器推送"><a href="#服务器推送" class="header-anchor">#</a> <strong>服务器推送</strong>：</h3> <p>Server push是HTTP/2中一个很强大的功能：</p> <ul><li>服务器除了响应客户端的请求外，还可以向客户端额外推送资源。</li> <li>服务器推送的资源有自己独立的URL， 可以被浏览器缓存，可以达到多页面共享。</li> <li>资源推送遵守同源策略，服务器不可随便推送第三方资源给客户端。</li> <li>客户端可以拒绝推送过来的资源。</li></ul> <p>服务端可以对一个客户端请求发送多个响应。</p> <ul><li>应用可以通过额外的http头部，列出需要服务器推送哪些资源。</li> <li>服务器可以解析请求的html，推测出客户端接下来需要请求的资源，然后提前向客户端推送。</li></ul> <p><strong>场景</strong>：服务器已经知道客户端下一步要请求什么资源，这时候服务推送即可派上用场</p> <p>服务器推送有一个很麻烦的问题。所要推送的资源文件，如果浏览器已经有缓存，推送就是浪费带宽。即使推送的文件版本更新，浏览器也会优先使用本地缓存。</p> <p>一种解决办法是，只对第一次访问的用户开启服务器推送。下面是 Nginx 官方给出的示例，根据 Cookie 判断是否为第一次访问。</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code>
server <span class="token punctuation">{</span>
    listen 443 ssl http2 default_server;

    ssl_certificate ssl/certificate.pem;
    ssl_certificate_key ssl/key.pem;

    root /var/www/html;
    http2_push_preload on;

    location = /demo.html <span class="token punctuation">{</span>
        add_header Set<span class="token punctuation">-</span>Cookie &quot;session=1&quot;;
        add_header Link $resources;
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


map $http_cookie $resources <span class="token punctuation">{</span>
    &quot;~<span class="token important">*session=1&quot;</span> &quot;&quot;;
    default &quot;&lt;/style.css<span class="token punctuation">&gt;</span>; as=style; rel=preload&quot;;
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h4 id="伪头字段"><a href="#伪头字段" class="header-anchor">#</a> <strong>伪头字段</strong></h4> <p>http2内置了几个特殊的已“:”开始的key，用以替代HTTP/1.x中请求行/响应行的信息</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>:method  请求方法
:scheme 请求协议
:authority 请求域名
:path 请求地址

:status 响应状态

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><img src="/learn-blog/dist/assets/img/image-20210317151643602.a2a99eac.png" alt="image-20210317151643602"></p> <h5 id="存在的缺点-其实是tcp的缺点"><a href="#存在的缺点-其实是tcp的缺点" class="header-anchor">#</a> 存在的缺点（其实是tcp的缺点）</h5> <ul><li>tcp 以及tcp+tls建立连接延时，两个握手延时</li> <li>tcp队头阻塞：队头阻塞会导致 HTTP/2 在更容易丢包的弱网络环境下比 HTTP/1.1 更慢</li></ul> <h3 id="http1-x存在的缺点"><a href="#http1-x存在的缺点" class="header-anchor">#</a> http1.x存在的缺点</h3> <p>1.请求阻塞 如上已清晰说明</p> <p>2.以明文文本字符串的形式传输内容，存在安全问题</p> <p>3.http 请求头无状态特性 导致传输效率低下
多个http请求头大部分信息是相同的，重复传输，导致宽带浪费.请求头多达几百字节，而请求主体却只有十几个字节，有效信息比很低。</p> <p>4.只能浏览器主动请求响应，不能服务器主动推送信息过来</p> <h3 id="http-3特点"><a href="#http-3特点" class="header-anchor">#</a> HTTP 3特点</h3> <p>基于QUIC协议（UDP协议）</p> <ul><li>减少了握手的延迟（1-RTT 或 0-RTT）</li> <li>多路复用，并且没有 TCP 的阻塞问题</li> <li>连接迁移，（主要是在客户端）当由 Wifi 转移到 4G 时，连接不会被断开</li></ul> <p>HTTP 3与HTTP 1.1和HTTP 2没有直接的关系，也不是http2的扩展</p> <p>HTTP 3将会是一个全新的WEB协议</p> <p>HTTP 3目前处于制订和测试阶段</p> <p>https://www.chromium.org/quic</p> <h2 id="http与代理"><a href="#http与代理" class="header-anchor">#</a> HTTP与代理</h2> <p><img src="/learn-blog/dist/assets/img/http_proxy.9956d058.png" alt="http3"></p> <h4 id="正向代理"><a href="#正向代理" class="header-anchor">#</a> 正向代理</h4> <p>正向代理代理一般是指代理客户端，为客户端收发请求，使真实客户端对服务器不可见</p> <h4 id="反向代理"><a href="#反向代理" class="header-anchor">#</a> 反向代理</h4> <p>反向代理是代理服务器端，为服务器收发请求，使真实服务器对客户端不可见</p> <h4 id="反向代理的用途"><a href="#反向代理的用途" class="header-anchor">#</a> 反向代理的用途</h4> <ul><li>加密和SSL加速</li> <li>负载均衡</li> <li>缓存静态内容</li> <li>压缩</li> <li>减速上传</li> <li>安全</li> <li>外网发布</li></ul> <h4 id="反向代理做负载均衡"><a href="#反向代理做负载均衡" class="header-anchor">#</a> 反向代理做负载均衡</h4> <p>反向代理服务器位于用户与目标服务器之间，但是对于用户而言，反向代理服务器就相当于目标服务器，即用户直接访问反向代理服务器就可以获得目标服务器的资源。同时，用户不需要知道目标服务器的地址，也无须在用户端作任何设定。反向代理服务器通常可用来作为Web加速，即使用反向代理作为Web服务器的前置机来降低网络和服务器的负载，提高访问效率;</p> <p><img src="/learn-blog/dist/assets/img/proxy_1.14139fe8.png" alt="http3"></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">5/20/2021, 1:44:11 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/learn-blog/dist/note/HTTP/DNS.html" class="prev">
        DNS
      </a></span> <span class="next"><a href="/learn-blog/dist/note/HTTP/RPC.html">
        RPC
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><section class="side-anchor"><ul style="display:none;"></ul></section></div></div>
    <script src="/learn-blog/dist/assets/js/app.af1090d3.js" defer></script><script src="/learn-blog/dist/assets/js/2.0abb358e.js" defer></script><script src="/learn-blog/dist/assets/js/6.9bb224b7.js" defer></script>
  </body>
</html>
