<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Webpack | 优化 &amp; 插件 | BINGO BLOG</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/learn-blog/dist/logo.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css">
    <meta name="description" content="BINGO BLOG 学然后知不足 非淡泊无以明志，非宁静无以致远">
    <meta name="keywords" content="博客，前端，代码，个人博客，学习，兴趣，BINGOBLOG">
    
    <link rel="preload" href="/learn-blog/dist/assets/css/0.styles.4b1e8fc9.css" as="style"><link rel="preload" href="/learn-blog/dist/assets/js/app.52f5dc38.js" as="script"><link rel="preload" href="/learn-blog/dist/assets/js/2.82d94c3a.js" as="script"><link rel="preload" href="/learn-blog/dist/assets/js/15.cba05378.js" as="script"><link rel="prefetch" href="/learn-blog/dist/assets/js/10.85697844.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/100.097ea31f.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/101.91bfe0f7.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/102.7ec42faf.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/103.e93fd210.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/104.f9acd0b8.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/105.1d84c070.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/11.862132d5.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/12.3c928f05.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/13.8017ce47.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/14.2c4af4ea.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/16.672f3bfe.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/17.fb8f4377.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/18.42cea3d7.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/19.b0c63c3a.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/20.1dd7c2bf.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/21.ba43e02f.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/22.d9662747.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/23.7caa29c9.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/24.8a9920f7.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/25.a879f446.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/26.08ec9831.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/27.121558b1.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/28.82af589a.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/29.8cfb18ca.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/3.db3fa96e.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/30.4fcd515d.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/31.b79d3f81.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/32.993d9c78.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/33.1b0882f2.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/34.7b867c68.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/35.b8014f1e.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/36.3c934e8c.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/37.3b25ee2b.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/38.6481f585.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/39.a193c2e3.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/4.4bf9cb71.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/40.8d8d358e.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/41.805b2bef.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/42.93982978.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/43.fcb2ef61.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/44.4b61d1d4.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/45.85fa4081.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/46.82911fdd.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/47.b78de3cf.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/48.472fc05e.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/49.b08fc4b6.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/5.0cf8d9cc.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/50.87fe0b84.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/51.a4c699bd.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/52.5ec3db77.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/53.f3195c55.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/54.c462ac35.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/55.ceb5b54c.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/56.32325193.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/57.a80072cc.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/58.8e88cdfa.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/59.7bdd58d0.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/6.ffd3dbd8.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/60.1ea43e6c.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/61.726f59b4.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/62.033fd75c.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/63.aee915e4.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/64.25fa4c4b.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/65.bf843de2.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/66.fcc71d7c.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/67.14285b58.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/68.ae890963.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/69.a7172230.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/7.17f76ed7.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/70.a1984b2d.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/71.de4fc393.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/72.c3f3ad41.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/73.d7c1df4a.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/74.d49ad169.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/75.37d7bf36.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/76.7f29d9b3.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/77.6ec4471b.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/78.36445094.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/79.6f4c7f55.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/8.336fac4a.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/80.b227520f.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/81.2b9dc7f1.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/82.fd3182b7.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/83.93c8543d.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/84.7e7223f7.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/85.fa2b54b5.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/86.19fcd045.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/87.888d6707.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/88.6c2aa1c8.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/89.77f57337.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/9.96fd1592.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/90.d2b1667f.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/91.b258e6b8.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/92.ef167d31.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/93.470108c4.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/94.046e636e.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/95.54b666ba.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/96.6bf992cf.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/97.bf59baed.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/98.672fe91d.js"><link rel="prefetch" href="/learn-blog/dist/assets/js/99.d33212c2.js">
    <link rel="stylesheet" href="/learn-blog/dist/assets/css/0.styles.4b1e8fc9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/learn-blog/dist/" class="home-link router-link-active"><img src="/learn-blog/dist/logo.png" alt="BINGO BLOG" class="logo"> <span class="site-name can-hide">BINGO BLOG</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/learn-blog/dist/note/" class="nav-link router-link-active">
  博客
</a></div><div class="nav-item"><a href="/learn-blog/dist/algorithm/" class="nav-link">
  算法
</a></div> <a href="https://github.com/bingoYB/learn-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/learn-blog/dist/note/" class="nav-link router-link-active">
  博客
</a></div><div class="nav-item"><a href="/learn-blog/dist/algorithm/" class="nav-link">
  算法
</a></div> <a href="https://github.com/bingoYB/learn-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>内推</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>编程思想</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTTP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>webpack</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn-blog/dist/note/webpack/webpack5新特性.html" class="sidebar-link">webpack5 新变化与对应的优化措施</a></li><li><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html" class="active sidebar-link">Webpack | 优化 &amp; 插件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#目的" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#思路" class="sidebar-link">思路</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#分析" class="sidebar-link">分析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#速度分析" class="sidebar-link">速度分析</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#输出文件分析" class="sidebar-link">输出文件分析</a></li></ul></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#缓存加速" class="sidebar-link">缓存加速</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#整个工程开启缓存" class="sidebar-link">整个工程开启缓存</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#cache-loader" class="sidebar-link">cache-loader</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#webpack5" class="sidebar-link">webpack5</a></li></ul></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#静态代码提取" class="sidebar-link">静态代码提取</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#多核优化与打包压缩" class="sidebar-link">多核优化与打包压缩</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#javascript" class="sidebar-link">javascript</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#css" class="sidebar-link">css</a></li></ul></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#资源处理" class="sidebar-link">资源处理</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#图片压缩" class="sidebar-link">图片压缩</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#html配置优化" class="sidebar-link">html配置优化</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#代码分析" class="sidebar-link">代码分析</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#错误提示优化" class="sidebar-link">错误提示优化</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#代码拆分" class="sidebar-link">代码拆分</a></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#polyfill引入" class="sidebar-link">polyfill引入</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#webpack5-2" class="sidebar-link">webpack5</a></li></ul></li><li class="sidebar-sub-header"><a href="/learn-blog/dist/note/webpack/webpack打包优化之路.html#优秀配置库搜集" class="sidebar-link">优秀配置库搜集</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端图形学</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端工程化</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack-优化-插件"><a href="#webpack-优化-插件" class="header-anchor">#</a> Webpack | 优化 &amp; 插件</h1> <h2 id="目的"><a href="#目的" class="header-anchor">#</a> 目的</h2> <p>webpack 是一款项目模块打包器，为我们项目开发带来很大的便利性，但是同时也会存在打包上的一些问题，为了提升打包体验，我们就需要对打包流程进行优化，主要优化目的有两个：</p> <ul><li>加快打包速度   ----提升开发上线体验</li> <li>减小打包出的文件体积     ----提升网页加载性能</li></ul> <h2 id="思路"><a href="#思路" class="header-anchor">#</a> 思路</h2> <ul><li><strong>打包分析</strong>：分析打包出的文件大小，与打包中各个环节的打包速度</li> <li><strong>缓存加速</strong>：利用缓存来加快打包速度</li> <li><strong>静态资源处理</strong>：提取出一些不变的静态代码库，放置外链中</li> <li><strong>多线程、多核加速</strong>：利用计算机多核的优势，进行多核压缩、打包</li> <li>html处理：利用H5的一些新特性，加快网页加载速度</li></ul> <p>...</p> <p>如果实在还是特别慢，嗯？😑 可以考虑集群编译吧，分模块打包，通过 jenkins 配置自动化，shell 脚本，通过免密登录 scp 到本地</p> <h2 id="分析"><a href="#分析" class="header-anchor">#</a> 分析</h2> <h3 id="速度分析"><a href="#速度分析" class="header-anchor">#</a> 速度分析</h3> <p>利用插件 <a href="https://www.npmjs.com/package/speed-measure-webpack-plugin" target="_blank" rel="noopener noreferrer">speed-measure-webpack-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>安装</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install --save-dev speed-measure-webpack-plugin
yarn add -D speed-measure-webpack-plugin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>使用</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> SpeedMeasurePlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;speed-measure-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> smp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpeedMeasurePlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> webpackConfig <span class="token operator">=</span> smp<span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span>webpackConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>使用结果</p> <p><img src="/learn-blog/dist/assets/img/preview.dd61e617.png" alt="Preview of Speed Measure Plugin's output"></p> <h3 id="输出文件分析"><a href="#输出文件分析" class="header-anchor">#</a> 输出文件分析</h3> <h4 id="工具一-webpack-dashboard"><a href="#工具一-webpack-dashboard" class="header-anchor">#</a> 工具一：<a href="https://www.npmjs.com/package/webpack-dashboard" target="_blank" rel="noopener noreferrer">webpack-dashboard<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>增强了 webpack 的输出，包含依赖的⼤⼩、进度和其他细节。</p> <p>安装</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install --save-dev webpack-dashboard
# ... or ...
yarn add --dev webpack-dashboard
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>使用</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> DashboardPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack-dashboard/plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Add it to your webpack configuration plugins.</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">DashboardPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>改变打包脚本</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;scripts&quot;: {
    &quot;dev&quot;: &quot;webpack-dashboard -- node index.js&quot;, # OR
    &quot;dev&quot;: &quot;webpack-dashboard -- webpack-dev-server&quot;, # OR
    &quot;dev&quot;: &quot;webpack-dashboard -- webpack&quot;,
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>使用效果</p> <p><img src="/learn-blog/dist/assets/img/test.3e6a881e.png" alt="http://i.imgur.com/qL6dXJd.png"></p> <h4 id="工具二-webpack-bundle-analyzer"><a href="#工具二-webpack-bundle-analyzer" class="header-anchor">#</a> 工具二：<a href="https://www.npmjs.com/package/webpack-bundle-analyzer" target="_blank" rel="noopener noreferrer">webpack-bundle-analyzer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>打包结果分析</p> <p>安装</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># NPM</span>
<span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack-bundle-analyzer
<span class="token comment"># Yarn</span>
<span class="token function">yarn</span> <span class="token function">add</span> -D webpack-bundle-analyzer
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>使用</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> BundleAnalyzerPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-bundle-analyzer'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>BundleAnalyzerPlugin<span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">BundleAnalyzerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><img src="/learn-blog/dist/assets/img/93f72404-b338-11e6-92d4-9a365550a701.76eb1584.gif" alt="webpack bundle analyzer zoomable treemap"></p> <h4 id="工具三-监控文件大小"><a href="#工具三-监控文件大小" class="header-anchor">#</a> 工具三：监控文件大小</h4> <p>集成到CI 监控⽂件的⼤⼩ https://github.com/siddharthkp/bundlesize</p> <h4 id="工具四-其他分析方式"><a href="#工具四-其他分析方式" class="header-anchor">#</a> 工具四：其他分析方式</h4> <p>执行以下命令，将输出的文件上传到<a href="http://alexkuz.github.io/webpack-chart/" target="_blank" rel="noopener noreferrer">webpack-chart<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>或者<a href="http://webpack.github.io/analyse/" target="_blank" rel="noopener noreferrer">analyse<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>上</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>webpack --profile --json &gt; stats.json
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="缓存加速"><a href="#缓存加速" class="header-anchor">#</a> 缓存加速</h2> <h3 id="整个工程开启缓存"><a href="#整个工程开启缓存" class="header-anchor">#</a> 整个工程开启缓存</h3> <p>有时候为了极致性能，可以使用该方法，强缓存，会缓存所有打包结果，慎用</p> <blockquote><p>就目前自己的使用体验上存在一定情况会抛出异常导致打包缓慢，所以慎用</p></blockquote> <p><a href="https://www.npmjs.com/package/hard-source-webpack-plugin" target="_blank" rel="noopener noreferrer">hard-source-webpack-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="cache-loader"><a href="#cache-loader" class="header-anchor">#</a> cache-loader</h3> <p>安装 <a href="https://www.npmjs.com/package/cache-loader" target="_blank" rel="noopener noreferrer">cache-loader<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install --save-dev cache-loader
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>根据前面的分析，在性能开销大的loader前面添加此loader，以将结果缓存到磁盘里</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.ext$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">'cache-loader'</span><span class="token punctuation">,</span>
          <span class="token operator">...</span>loaders
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token comment">// 排除不处理的⽬录</span>
        include<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span> <span class="token comment">// 精确指定要处理的⽬录</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>babel-loader的缓存</p> <p>loader的缓存 =&gt; 'babel-loader?cacheDirectory=true'</p> <h3 id="webpack5"><a href="#webpack5" class="header-anchor">#</a> webpack5</h3> <p>到了webpack5，可以通过cache 特性来将webpack工作缓存到硬盘中。存放的路径为<code>node_modules/.cache/webpack</code></p> <ol><li>开发环境默认值为 cache.type = &quot;memory&quot;。</li> <li>生产环境可手动设为 cache.type = &quot;filesystem&quot;。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  cache<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'filesystem'</span><span class="token punctuation">,</span>
    version<span class="token operator">:</span> <span class="token string">'your_version'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="静态代码提取"><a href="#静态代码提取" class="header-anchor">#</a> 静态代码提取</h2> <p>将公共的UI库，框架库等提取处理，放进html中通过script、link标签引入，减少打包时间</p> <p>因为一般公共库都有压缩版本，可直接引入</p> <blockquote><p>一般项目中业务代码不多的情况下，这种方式能直接提速80%</p></blockquote> <h2 id="多核优化与打包压缩"><a href="#多核优化与打包压缩" class="header-anchor">#</a> 多核优化与打包压缩</h2> <h3 id="javascript"><a href="#javascript" class="header-anchor">#</a> javascript</h3> <h5 id="treeshaking-深度分析"><a href="#treeshaking-深度分析" class="header-anchor">#</a> treeShaking 深度分析</h5> <blockquote><p>用于描述移除 JavaScript 上下文中的未引用代码(dead-code)。它依赖于 ES2015 模块系统中的<a href="http://exploringjs.com/es6/ch_modules.html#static-module-structure" target="_blank" rel="noopener noreferrer">静态结构特性<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，例如 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" target="_blank" rel="noopener noreferrer"><code>import</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 和 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export" target="_blank" rel="noopener noreferrer"><code>export</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。这个术语和概念实际上是兴起于 ES2015 模块打包工具 <a href="https://github.com/rollup/rollup" target="_blank" rel="noopener noreferrer">rollup<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p></blockquote> <p>新的 webpack 4 正式版本，扩展了这个检测能力，通过 <code>package.json</code> 的 <code>&quot;sideEffects&quot;</code> 属性作为标记，向 compiler 提供提示，表明项目中的哪些文件是 &quot;pure(纯的 ES2015 模块)&quot;，由此可以安全地删除文件中未使用的部分。<a href="https://www.webpackjs.com/guides/tree-shaking/#%E5%B0%86%E6%96%87%E4%BB%B6%E6%A0%87%E8%AE%B0%E4%B8%BA%E6%97%A0%E5%89%AF%E4%BD%9C%E7%94%A8-side-effect-free-" target="_blank" rel="noopener noreferrer">点击了解<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>相关插件</p> <ul><li><a href="https://www.npmjs.com/package/webpack-deep-scope-plugin" target="_blank" rel="noopener noreferrer">webpack-deep-scope-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>  提升treeShaking能力的一款插件；它可以使 webpack 消除与未使用导出相关的未使用导入，解决了 webpack 的6254问题。</li> <li><a href="https://www.npmjs.com/package/webpack-parallel-uglify-plugin" target="_blank" rel="noopener noreferrer">webpack-parallel-uglify-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 这个插件为有许多入口点的项目加快构建速度。带有 webpack 的 UglifyJS 插件按顺序运行每个输出文件。这个插件并行运行 uglify，每个可用的 cpu 都有一个线程。这可以导致显着减少构建时间，因为缩小是非常 CPU 密集。</li> <li><a href="https://www.npmjs.com/package/purgecss-webpack-plugin" target="_blank" rel="noopener noreferrer">purifycss-webpack-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 一个webpack插件用于剔除未使用的css</li></ul> <h5 id="多线程编译"><a href="#多线程编译" class="header-anchor">#</a> 多线程编译</h5> <ol><li>开启多核压缩 <a href="https://www.npmjs.com/package/happypack" target="_blank" rel="noopener noreferrer">happypack<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 多线程编译</li> <li>webpack 不⽀持的情况下使⽤ <a href="https://www.npmjs.com/package/thread-loader" target="_blank" rel="noopener noreferrer">thread-loader<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <strong>请仅在耗时的 loader 上使用</strong>，</li></ol> <h5 id="多线程压缩"><a href="#多线程压缩" class="header-anchor">#</a> 多线程压缩</h5> <p>JavaScript的多核压缩可以开启 <a href="https://www.npmjs.com/package/terser-webpack-plugin" target="_blank" rel="noopener noreferrer">terser-webpack-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (多核压缩）</p> <p>terserPlugin是webpack推荐及内置的压缩插件，cache与parallel默认为开启状态</p> <p><a href="https://www.npmjs.com/package/uglifyjs-webpack-plugin" target="_blank" rel="noopener noreferrer">uglifyjs-webpack-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 官⽅维护插件</p> <p><a href="https://www.npmjs.com/package/webpack-parallel-uglify-plugin" target="_blank" rel="noopener noreferrer">webpack-parallel-uglify-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ⾮官⽅维护</p> <h5 id="webpack-5"><a href="#webpack-5" class="header-anchor">#</a> WEBPACK 5</h5> <blockquote><p>Webpack5 不间断进程（continuous processes）和缓存对于⼤型复杂项⽬应⽤，在开发阶段，开发者⼀般习惯使⽤ Webpack --watch 选项或者webpack devServer 启动⼀个不间断的进程（continuous processes）以达到最佳的构建速度和效率。Webpack --watch 选项和 webpack-dev-server 都会监听⽂件系统，进⽽在必要时，触发持续编译构建动作。</p></blockquote> <p>原理其实就是轮询判断⽂件的最后编辑时间是否变化，某个⽂件发⽣了变化，并不会⽴刻告诉监听者，⽽是先缓存起来，等待aggregateTimeout（Webpack 的 --watch 选项内置的类似 batching 的能⼒）https://github.com/paulmillr/chokidar</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> TerserJSPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'terser-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    minimizer<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">TerserJSPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      cache<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否缓存</span>
      parallel<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否并⾏打包</span>
      sourceMap<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="css"><a href="#css" class="header-anchor">#</a> css</h3> <p>CSS的多核压缩 <a href="https://www.npmjs.com/package/optimize-css-assets-webpack-plugin" target="_blank" rel="noopener noreferrer">optimize-css-assets-webpack-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="资源处理"><a href="#资源处理" class="header-anchor">#</a> 资源处理</h2> <p><a href="https://www.npmjs.com/package/html-inline-css-webpack-plugin" target="_blank" rel="noopener noreferrer">html-inline-css-webpack-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 把⼀些核⼼的CSS放到⻚⾯内部</p> <p>需要<a href="https://github.com/webpack-contrib/mini-css-extract-plugin" target="_blank" rel="noopener noreferrer">mini-css-extract-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>和<a href="https://github.com/jantimon/html-webpack-plugin" target="_blank" rel="noopener noreferrer">html-webpack-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;link rel=&quot;stylesheet&quot; /&gt; =&gt; &lt;style&gt;...&lt;style/&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><a href="https://www.npmjs.com/package/html-webpack-inline-source-plugin" target="_blank" rel="noopener noreferrer">html-webpack-inline-source-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>  这是一个扩展插件的 webpack 插件 html-webpack-plugin。它允许你嵌入 javascript 和 css 源代码内嵌。</p> <h2 id="图片压缩"><a href="#图片压缩" class="header-anchor">#</a> 图片压缩</h2> <p>压缩图⽚ <a href="https://www.npmjs.com/package/image-webpack-loader" target="_blank" rel="noopener noreferrer">image-webpack-loader<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="html配置优化"><a href="#html配置优化" class="header-anchor">#</a> html配置优化</h2> <p><a href="https://www.npmjs.com/package/html-webpack-plugin" target="_blank" rel="noopener noreferrer">html-webpack-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> html</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  inlineSource<span class="token operator">:</span> <span class="token string">&quot;.css$&quot;</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/index.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  filename<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  chunks<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;vendors&quot;</span><span class="token punctuation">,</span> pageName<span class="token punctuation">]</span><span class="token punctuation">,</span>
  inject<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  minify<span class="token operator">:</span> <span class="token punctuation">{</span>
    html5<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    collapseWhitespace<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    preserveLineBreaks<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    minifyCSS<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    minifyJS<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    removeComments<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="代码分析"><a href="#代码分析" class="header-anchor">#</a> 代码分析</h2> <p><a href="https://www.npmjs.com/package/prepack-webpack-plugin" target="_blank" rel="noopener noreferrer">prepack-webpack-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>  代码求值，静态代码分析</p> <p><a href="https://www.npmjs.com/package/@babel/plugin-syntax-dynamic-import" target="_blank" rel="noopener noreferrer">@babel/plugin-syntax-dynamic-import<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 动态引⼊</p> <h2 id="错误提示优化"><a href="#错误提示优化" class="header-anchor">#</a> 错误提示优化</h2> <p>友好错误提示 <a href="https://www.npmjs.com/package/friendly-errors-webpack-plugin" target="_blank" rel="noopener noreferrer">friendly-errors-webpack-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>系统通知，本地 dev使用  <a href="https://www.npmjs.com/package/webpack-build-notifier" target="_blank" rel="noopener noreferrer">webpack-build-notifier<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="代码拆分"><a href="#代码拆分" class="header-anchor">#</a> 代码拆分</h2> <p>externals 配置去掉不需要编译的，可以抛弃 dll</p> <p>splitChunks 公⽤库的代码拆分 去除打包</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>splitChunks<span class="token operator">:</span> <span class="token punctuation">{</span>
  chunks<span class="token operator">:</span> <span class="token string">'async'</span><span class="token punctuation">,</span>
  minSize<span class="token operator">:</span> <span class="token number">30000</span><span class="token punctuation">,</span>
  minChunks<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  maxAsyncRequests<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  maxInitialRequests<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  name<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  cacheGroups<span class="token operator">:</span> <span class="token punctuation">{</span>
    commons<span class="token operator">:</span> <span class="token punctuation">{</span>
      chunks<span class="token operator">:</span> <span class="token string">'initial'</span><span class="token punctuation">,</span>
      minChunks<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      maxInitialRequests<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
      minSize<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">'commons'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>分离⻚⾯公⽤包 <a href="https://www.npmjs.com/package/html-webpack-externals-plugin" target="_blank" rel="noopener noreferrer">html-webpack-externals-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="polyfill引入"><a href="#polyfill引入" class="header-anchor">#</a> polyfill引入</h2> <p>js脚本直接引入，不编译</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.polyfill.io/v2/polyfill.min.js?feature=Map,Set<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>使⽤动态 polyfill, 它会根据你的浏览器 UA 头，判断你是否⽀持某些特性，从⽽返回给你⼀个合适的 polyfill</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">nomodule</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main.es5.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="webpack5-2"><a href="#webpack5-2" class="header-anchor">#</a> webpack5</h3> <p>在webpack5之前，webpack会自动的帮我们项目引入Node全局模块polyfill。我们可以通过node配置</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// false: 不提供任何方法（可能会造成bug），'empty':  引入空模块, 'mock': 引入一个mock模块，但功能很少</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  node<span class="token operator">:</span> <span class="token punctuation">{</span>
    console<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    global<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    process<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>但是webpack团队认为，现在大多数工具包多是为前端用途而编写的，所以不再自动引入polyfill。我们需要自行判断是否需要引入polyfill，当我们用weback5打包的时候，webpack会给我们类似如下的提示：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>// 在项目中我使用到了 crypto 模块，webpack5会询问是否引入对应的 polyfill。
Module not found: Error: Can't resolve 'crypto' in '/Users/xxx/Documents/private-project/webpack/ac_repair_mobile_webpack_5/node_modules/sshpk/lib/formats'

BREAKING CHANGE: webpack &lt; 5 used to include polyfills for node.js core modules by default.
This is no longer the case. Verify if you need these module and configure a polyfill for it.

If you want to include a polyfill, you need to:
        - add an alias 'resolve.alias: { &quot;crypto&quot;: &quot;crypto-browserify&quot; }'
        - install 'crypto-browserify'
If you don't want to include a polyfill, you can use an empty module like this:
        resolve.alias: { &quot;crypto&quot;: false }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>webpack5中，增加了resolve.alias配置项来告诉webpack是否需要引入对应polyfill。node配置项也做了调整。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    alias<span class="token operator">:</span> <span class="token punctuation">{</span>
      crypto<span class="token operator">:</span> <span class="token string">'crypto-browserify'</span><span class="token punctuation">,</span>
      <span class="token comment">// ..</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>  
  node<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// https://webpack.js.org/configuration/node/#root</span>
    <span class="token comment">// 只能配置这三个</span>
    global<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    __filename<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    __dirname<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="优秀配置库搜集"><a href="#优秀配置库搜集" class="header-anchor">#</a> 优秀配置库搜集</h2> <p>构建配置设计成⼀个库</p> <p>hjs-webpack、Neutrino、webpack-blocks</p> <p>抽成⼀个⼯具进⾏管理</p> <p>create-react-app, kyt, nwb</p> <p>更多的快速构建⼯具</p> <p>lerna 、brunch、 rome 、snowpack （过往Browserify、Rollup.js、Gulp、Parcel、Microbundle）</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">11/18/2021, 9:39:46 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/learn-blog/dist/note/webpack/webpack5新特性.html" class="prev">
        webpack5 新变化与对应的优化措施
      </a></span> <span class="next"><a href="/learn-blog/dist/note/engineering/前端工程化.html">
        前端工程化
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><section class="side-anchor"><ul style="display:none;"></ul></section></div></div>
    <script src="/learn-blog/dist/assets/js/app.52f5dc38.js" defer></script><script src="/learn-blog/dist/assets/js/2.82d94c3a.js" defer></script><script src="/learn-blog/dist/assets/js/15.cba05378.js" defer></script>
  </body>
</html>
